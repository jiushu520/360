<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>左右分栏页面</title>
    <style>
        /* 页面整体布局 */
        .container {
            display: flex;
            height: 100vh;
        }

        /* 左边和右边容器样式 */
        .left-container, .right-container {
            flex: 1;
            border: 1px solid #ccc;
            overflow: hidden;
        }

        /* 让iframe充满整个容器 */
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 左边容器 -->
        <div class="left-container">
            <iframe src="./draw.html"></iframe>
        </div>

        <!-- 右边容器 -->
        <div class="right-container">
            <iframe src="./tu.html"></iframe>
        </div>
    </div>

    <!-- 一键发送画布内容按钮 -->
    <button id="copyAndSendButton" style="position: fixed; top: 10px; right: 10px; padding: 10px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">
        一键发送画布内容
    </button>

    <script>
        document.getElementById("copyAndSendButton").addEventListener("click", async () => {
            // 获取 draw.html 中的画布内容
            const drawIframe = document.querySelector(".left-container iframe").contentWindow;
            const canvas = drawIframe.document.getElementById("drawingCanvas");
            const textInput = document.querySelector(".right-container iframe").contentWindow.document.getElementById("textInput");
            const sendButton = document.querySelector(".right-container iframe").contentWindow.document.getElementById("sendBtn");

            // 创建临时画布，将内容拷贝成 Base64 图像
            const tempCanvas = document.createElement("canvas");
            tempCanvas.width = canvas.width;
            tempCanvas.height = canvas.height;
            const tempCtx = tempCanvas.getContext("2d");
            tempCtx.drawImage(canvas, 0, 0);

            // 将内容转为Base64格式并插入输入框
            const base64Image = tempCanvas.toDataURL("image/png");
            const imgTag = `<img src="${base64Image}" style="max-width:100%; max-height:200px;">`;
            textInput.innerHTML = imgTag;

            // 启用发送按钮并模拟点击发送
            sendButton.disabled = false;
            sendButton.click();
        });
    </script>
</body>
</html>
